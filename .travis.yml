dist: trusty
language: c
sudo: false

addons:
  apt:
    packages:
      - texinfo

cache:
  directories:
  - work
  - .toolchains

jobs:
  include:
  - stage: setup
    script: make setup
  - stage: binutils
    script:
      - export m68k_prefix=`pwd`/.toolchains/gen/m68k-elf
      - cd work
      - travis_wait 90 make -f ../gen_gcc/makefile-gen build-m68k-binutils
  - stage: pass1
    script:
      - find .toolchains
      - export m68k_prefix=`pwd`/.toolchains/gen/m68k-elf
      - cd work
      - travis_wait 90 make -f ../gen_gcc/makefile-gen build-m68k-gcc-pass1
  - stage: newlib
    script:
      - find .toolchains
      - export m68k_prefix=`pwd`/.toolchains/gen/m68k-elf
      - cd work
      - travis_wait 90 make -f ../gen_gcc/makefile-gen build-m68k-newlib
  - stage: pass2
    script:
      - find .toolchains
      - export m68k_prefix=`pwd`/.toolchains/gen/m68k-elf
      - cd work
      - travis_wait 90 make -f ../gen_gcc/makefile-gen build-m68k-gcc-pass2
  - stage: sgdk
    script:
      - find .toolchains
      - export GENDEV=`pwd`/.toolchains/gen
      - make $GENDEV/ldscripts
      - make tools
      - make sgdk_build
      - find .toolchains

#script:
#  - make setup
  #- travis_wait 90 make toolchain_build GENDEV=".toolchain" SUDO=""
  #  - cd work
  #- travis_wait 90 make -f ../gen_gcc/makefile-gen build-m68k-binutils
  #- travis_wait 90 make -f ../gen_gcc/makefile-gen build-m68k-gcc-pass1
  #- travis_wait 90 make -f ../gen_gcc/makefile-gen build-m68k-newlib
  #- travis_wait 90 make -f ../gen_gcc/makefile-gen build-m68k-gcc-pass2
  #- cd ..
  #- export GENDEV=`pwd`/.toolchain
  #- make $GENDEV/ldscripts
  #- make tools
  #- make sgdk_build
